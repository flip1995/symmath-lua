<!doctype html>
<html>
	<head>
		<meta charset='utf-8'>
		<title>Shallow Water Equations - flux eigenvectors</title>
		<script type='text/javascript' src='./tryToFindMathJax.js'></script>
	</head>
	<body onload='tryToFindMathJax();'>

variables:
<br>
${ n}^i$	= flux surface normal, in units of $[1]$
<br>
$h$	= wave height, in units of 	$m$
<br>
${ v}^i$	= velocity, in units of 	${\frac{1}{s}}{({m})}$
<br>
${{ m}^i} = {{{h}} {{{ v}^i}}}$	= momentum, in units of 	$\frac{kg}{{{{m}^{2}}} {{s}}}$
<br>
$\gamma$	= pull of gravitation, in units of 	$\frac{m}{{s}^{2}}$
<br>
$H$	= seafloor depth, in units of 	$m$
<br>
${\eta} = {{h} - {H}}$	= difference in wave height above resting height in units of 	$m$
<br>
${c} = {\sqrt{{{\gamma}} \cdot {{\eta}}}}$	= speed of sound in units of 	${\frac{1}{s}}{({m})}$
<br>
${{ g}_i}_j$	= metric tensor, in units of $[1]$
<br>
Conservative and primitive variables:
<br>
${{ W}^I} = {\left[\begin{matrix}  h \\  { v}^i\end{matrix}\right]}$
<br>
${{ U}^I} = {\left[\begin{matrix}  h \\  { m}^i\end{matrix}\right]}$
<br>
Partial of conservative quantities wrt primitives:
<br>
${\frac{\partial { U}^I}{\partial { W}^J}} = {\left[\begin{matrix}  \frac{\partial h}{\partial h} &  \frac{\partial h}{\partial { v}^j} \\  \frac{\partial { m}^i}{\partial h} &  \frac{\partial { m}^i}{\partial { v}^j}\end{matrix}\right]}$
<br>
${\frac{\partial { U}^I}{\partial { W}^J}} = {\left[\begin{matrix}  \frac{\partial h}{\partial h} &  \frac{\partial h}{\partial { v}^j} \\  {\frac{\partial}{\partial h}}\left({{{h}} {{{ v}^i}}}\right) &  {\frac{\partial}{\partial { v}^j}}\left({{{h}} {{{ v}^i}}}\right)\end{matrix}\right]}$
<br>
${\frac{\partial { U}^I}{\partial { W}^J}} = {\left[\begin{matrix}  1 &  0 \\  { v}^i &  {{h}} {{{{ \delta}^i}_j}}\end{matrix}\right]}$
<br>
${\frac{\partial { U}^I}{\partial { W}^J}} = {\left[\begin{matrix}  1 &  0 &  0 &  0 \\  { v}^1 &  h &  0 &  0 \\  { v}^2 &  0 &  h &  0 \\  { v}^3 &  0 &  0 &  h\end{matrix}\right]}$
<br>
${\frac{\partial { W}^I}{\partial { U}^J}} = {\left[\begin{matrix}  1 &  0 &  0 &  0 \\  {\frac{1}{h}}{({-{{ v}^1}})} &  \frac{1}{h} &  0 &  0 \\  {\frac{1}{h}}{({-{{ v}^2}})} &  0 &  \frac{1}{h} &  0 \\  {\frac{1}{h}}{({-{{ v}^3}})} &  0 &  0 &  \frac{1}{h}\end{matrix}\right]}$
<br>
${\frac{\partial { W}^I}{\partial { U}^J}} = {\left[\begin{matrix}  1 &  0 \\  {\frac{1}{h}}{({-{{ v}^i}})} &  {\frac{1}{h}}{({{{ \delta}^i}_j})}\end{matrix}\right]}$
<br>

<br>
Flux:
<br>
${{ F}^I} = {\left[\begin{matrix}  {{h}} {{{ v}^j}} {{{ n}_j}} \\  {{{h}} {{{ v}^i}} {{{ v}^j}} {{{ n}_j}}} + {{{\frac{1}{2}}} {{\gamma}} \cdot {{({{{h}^{2}} - {{{2}} {{h}} {{H}}}})}} {{{ n}^i}}}\end{matrix}\right]}$
<br>
${{ F}^I} = {\left[\begin{matrix}  {{h}} {{{ n}_j}} {{{ v}^j}} \\  {{{-1}} {{H}} {{\gamma}} \cdot {{h}} {{{ n}^i}}} + {{{\frac{1}{2}}} {{\gamma}} \cdot {{{ n}^i}} {{{h}^{2}}}} + {{{h}} {{{ n}_j}} {{{ v}^i}} {{{ v}^j}}}\end{matrix}\right]}$
<br>

<br>
Flux derivative wrt primitive variables:
<br>
${\frac{\partial { F}^I}{\partial { W}^J}} = {\left[\begin{matrix}  {\frac{\partial}{\partial h}}\left({{{h}} {{{ n}_k}} {{{ v}^k}}}\right) &  {\frac{\partial}{\partial { v}^j}}\left({{{h}} {{{ n}_k}} {{{ v}^k}}}\right) \\  {\frac{\partial}{\partial h}}\left({{{{-1}} {{H}} {{\gamma}} \cdot {{h}} {{{ n}^i}}} + {{{\frac{1}{2}}} {{\gamma}} \cdot {{{ n}^i}} {{{h}^{2}}}} + {{{h}} {{{ n}_k}} {{{ v}^i}} {{{ v}^k}}}}\right) &  {\frac{\partial}{\partial { v}^j}}\left({{{{-1}} {{H}} {{\gamma}} \cdot {{h}} {{{ n}^i}}} + {{{\frac{1}{2}}} {{\gamma}} \cdot {{{ n}^i}} {{{h}^{2}}}} + {{{h}} {{{ n}_k}} {{{ v}^i}} {{{ v}^k}}}}\right)\end{matrix}\right]}$
<br>
${\frac{\partial { F}^I}{\partial { W}^J}} = {\left[\begin{matrix}  {{{ n}_k}} {{{ v}^k}} &  {{h}} {{{ n}_j}} \\  {{{-1}} {{H}} {{\gamma}} \cdot {{{ n}^i}}} + {{{{ n}_k}} {{{ v}^i}} {{{ v}^k}}} + {{{\gamma}} \cdot {{h}} {{{ n}^i}}} &  {{{h}} {{{ n}_j}} {{{ v}^i}}} + {{{h}} {{{ n}_k}} {{{ v}^k}} {{{{ \delta}^i}_j}}}\end{matrix}\right]}$
<br>
${\frac{\partial { F}^I}{\partial { W}^J}} = {\left[\begin{matrix}  {{{ n}_a}} {{{ v}^a}} &  {{h}} {{{ n}_j}} \\  {{{-1}} {{H}} {{\gamma}} \cdot {{{ n}^i}}} + {{{{ n}_a}} {{{ v}^a}} {{{ v}^i}}} + {{{\gamma}} \cdot {{h}} {{{ n}^i}}} &  {{{h}} {{{ n}_a}} {{{ v}^a}} {{{{ \delta}^i}_j}}} + {{{h}} {{{ n}_j}} {{{ v}^i}}}\end{matrix}\right]}$
<br>

<br>
Flux derivative wrt conserved variables:
<br>
${\frac{\partial { F}^I}{\partial { U}^J}} = {{{\frac{\partial { F}^I}{\partial { W}^L}}} {{\frac{\partial { W}^L}{\partial { U}^J}}}}$
<br>
${\frac{\partial { F}^I}{\partial { U}^J}} = { {\left[\begin{matrix}  {{{ n}_a}} {{{ v}^a}} &  {{h}} {{{ n}_k}} \\  {{{-1}} {{H}} {{\gamma}} \cdot {{{ n}^i}}} + {{{{ n}_a}} {{{ v}^a}} {{{ v}^i}}} + {{{\gamma}} \cdot {{h}} {{{ n}^i}}} &  {{{h}} {{{ n}_a}} {{{ v}^a}} {{{{ \delta}^i}_k}}} + {{{h}} {{{ n}_k}} {{{ v}^i}}}\end{matrix}\right]}  {\left[\begin{matrix}  1 &  0 \\  {\frac{1}{h}}{({-{{ v}^k}})} &  {\frac{1}{h}}{({{{ \delta}^k}_j})}\end{matrix}\right]}}$
<br>
${\frac{\partial { F}^I}{\partial { U}^J}} = {\left[\begin{matrix}  {{{{ n}_a}} {{{ v}^a}}} + {{{-1}} {{{ n}_k}} {{{ v}^k}}} &  {{{ n}_k}} {{{{ \delta}^k}_j}} \\  {{{-1}} {{H}} {{\gamma}} \cdot {{{ n}^i}}} + {{{{ n}_a}} {{{ v}^a}} {{{ v}^i}}} + {{{-1}} {{{ n}_a}} {{{ v}^a}} {{{ v}^k}} {{{{ \delta}^i}_k}}} + {{{-1}} {{{ n}_k}} {{{ v}^i}} {{{ v}^k}}} + {{{\gamma}} \cdot {{h}} {{{ n}^i}}} &  {{{{ n}_a}} {{{ v}^a}} {{{{ \delta}^i}_k}} {{{{ \delta}^k}_j}}} + {{{{ n}_k}} {{{ v}^i}} {{{{ \delta}^k}_j}}}\end{matrix}\right]}$
<br>
${\frac{\partial { F}^I}{\partial { U}^J}} = {\left[\begin{matrix}  0 &  { n}_j \\  {{{-1}} {{H}} {{\gamma}} \cdot {{{ n}^i}}} + {{{-1}} {{{ n}_a}} {{{ v}^a}} {{{ v}^i}}} + {{{\gamma}} \cdot {{h}} {{{ n}^i}}} &  {{{{ n}_j}} {{{ v}^i}}} + {{{{ n}_a}} {{{ v}^a}} {{{{ \delta}^i}_j}}}\end{matrix}\right]}$
<br>

<br>
Flux derivative matrix times state
<br>
${{{\frac{\partial { F}^I}{\partial { U}^J}}} {{U}}} = { {\left[\begin{matrix}  0 &  { n}_j \\  {{{-1}} {{H}} {{\gamma}} \cdot {{{ n}^i}}} + {{{-1}} {{{ n}_a}} {{{ v}^a}} {{{ v}^i}}} + {{{\gamma}} \cdot {{h}} {{{ n}^i}}} &  {{{{ n}_j}} {{{ v}^i}}} + {{{{ n}_a}} {{{ v}^a}} {{{{ \delta}^i}_j}}}\end{matrix}\right]}  {\left[\begin{matrix}  h \\  { m}^j\end{matrix}\right]}}$
<br>
${{{\frac{\partial { F}^I}{\partial { U}^J}}} {{U}}} = { {\left[\begin{matrix}  0 &  { n}_j \\  {{{-1}} {{H}} {{\gamma}} \cdot {{{ n}^i}}} + {{{-1}} {{{ n}_a}} {{{ v}^a}} {{{ v}^i}}} + {{{\gamma}} \cdot {{h}} {{{ n}^i}}} &  {{{{ n}_j}} {{{ v}^i}}} + {{{{ n}_a}} {{{ v}^a}} {{{{ \delta}^i}_j}}}\end{matrix}\right]}  {\left[\begin{matrix}  h \\  {{h}} {{{ v}^j}}\end{matrix}\right]}}$
<br>
${{{\frac{\partial { F}^I}{\partial { U}^J}}} {{U}}} = {\left[\begin{matrix}  {{h}} {{{ n}_j}} {{{ v}^j}} \\  -{{{h}} {{({{{{{H}} {{\gamma}} \cdot {{{ n}^i}}} - {{{\gamma}} \cdot {{h}} {{{ n}^i}}}} + {{{{{{ n}_a}} {{{ v}^a}} {{{ v}^i}}} - {{{{ n}_a}} {{{ v}^a}} {{{ v}^j}} {{{{ \delta}^i}_j}}}} - {{{{ n}_j}} {{{ v}^i}} {{{ v}^j}}}}})}}}\end{matrix}\right]}$
<br>
${{{\frac{\partial { F}^I}{\partial { U}^J}}} {{U}}} = {\left[\begin{matrix}  {{h}} {{{ n}_j}} {{{ v}^j}} \\  {{{-1}} {{H}} {{\gamma}} \cdot {{h}} {{{ n}^i}}} + {{{\gamma}} \cdot {{{ n}^i}} {{{h}^{2}}}} + {{{h}} {{{ n}_j}} {{{ v}^i}} {{{ v}^j}}}\end{matrix}\right]}$
<br>
${{ F}^I} = {\left[\begin{matrix}  {{h}} {{{ n}_j}} {{{ v}^j}} \\  {{{-1}} {{H}} {{\gamma}} \cdot {{h}} {{{ n}^i}}} + {{{\frac{1}{2}}} {{\gamma}} \cdot {{{ n}^i}} {{{h}^{2}}}} + {{{h}} {{{ n}_j}} {{{ v}^i}} {{{ v}^j}}}\end{matrix}\right]}$
<br>

<br>
As you can see, the shallow water equations' $\frac{\partial F}{\partial U} \cdot U \ne F$.  This statement happens to be true for the Euler fluid equations, and lots of literature of solvers based on the Euler fluid equations depend on this equality, which is simply not always true.
<br>

<br>
Flux derivative wrt conserved variables, expanded:
<br>
${\frac{\partial { F}^I}{\partial { U}^J}} = {\left[\begin{matrix}  0 &  { n}_1 &  { n}_2 &  { n}_3 \\  -{({{{{H}} {{\gamma}} \cdot {{{ n}^1}}} + {{{{{ v}^1}} {{{{{ n}_k}} {{{ v}^k}}}}} - {{{\gamma}} \cdot {{h}} {{{ n}^1}}}}})} &  {{{{ n}_1}} {{{ v}^1}}} + {{{{ n}_k}} {{{ v}^k}}} &  {{{ n}_2}} {{{ v}^1}} &  {{{ n}_3}} {{{ v}^1}} \\  -{({{{{H}} {{\gamma}} \cdot {{{ n}^2}}} + {{{{{ v}^2}} {{{{{ n}_k}} {{{ v}^k}}}}} - {{{\gamma}} \cdot {{h}} {{{ n}^2}}}}})} &  {{{ n}_1}} {{{ v}^2}} &  {{{{ n}_2}} {{{ v}^2}}} + {{{{ n}_k}} {{{ v}^k}}} &  {{{ n}_3}} {{{ v}^2}} \\  -{({{{{H}} {{\gamma}} \cdot {{{ n}^3}}} + {{{{{ v}^3}} {{{{{ n}_k}} {{{ v}^k}}}}} - {{{\gamma}} \cdot {{h}} {{{ n}^3}}}}})} &  {{{ n}_1}} {{{ v}^3}} &  {{{ n}_2}} {{{ v}^3}} &  {{{{ n}_3}} {{{ v}^3}}} + {{{{ n}_k}} {{{ v}^k}}}\end{matrix}\right]}$
<br>

<br>
Acoustic matrix:
<br>
${{{{ A}^I}_J} + {{{{ n}_a}} {{{ v}^a}} {{{{ \delta}^I}_J}}}} = {{{\frac{\partial { W}^I}{\partial { U}^K}}} {{\frac{\partial { F}^K}{\partial { W}^J}}}}$
<br>
${{{{ A}^I}_J} + {{{{ n}_a}} {{{ v}^a}} {{{{ \delta}^I}_J}}}} = { {\left[\begin{matrix}  1 &  0 \\  {\frac{1}{h}}{({-{{ v}^i}})} &  {\frac{1}{h}}{({{{ \delta}^i}_k})}\end{matrix}\right]}  {\left[\begin{matrix}  {{{ n}_a}} {{{ v}^a}} &  {{h}} {{{ n}_j}} \\  {{{-1}} {{H}} {{\gamma}} \cdot {{{ n}^k}}} + {{{{ n}_a}} {{{ v}^a}} {{{ v}^k}}} + {{{\gamma}} \cdot {{h}} {{{ n}^k}}} &  {{{h}} {{{ n}_a}} {{{ v}^a}} {{{{ \delta}^k}_j}}} + {{{h}} {{{ n}_j}} {{{ v}^k}}}\end{matrix}\right]}}$
<br>
${{{{ A}^I}_J} + {{{{ n}_a}} {{{ v}^a}} {{{{ \delta}^I}_J}}}} = {\left[\begin{matrix}  {{{ n}_a}} {{{ v}^a}} &  {{h}} {{{ n}_j}} \\  {\frac{1}{h}}{({-{({{{{H}} {{\gamma}} \cdot {{{ n}^k}} {{{{ \delta}^i}_k}}} + {{{{{{ n}_a}} {{{ v}^a}} {{{ v}^i}}} - {{{{ n}_a}} {{{ v}^a}} {{{ v}^k}} {{{{ \delta}^i}_k}}}} - {{{\gamma}} \cdot {{h}} {{{ n}^k}} {{{{ \delta}^i}_k}}}}})}})} &  {{{{{ n}_a}} {{{ v}^a}} {{{{ \delta}^i}_k}} {{{{ \delta}^k}_j}}} - {{{{ n}_j}} {{{ v}^i}}}} + {{{{ n}_j}} {{{ v}^k}} {{{{ \delta}^i}_k}}}\end{matrix}\right]}$
<br>
${{{{ A}^I}_J} + {{{{ n}_a}} {{{ v}^a}} {{{{ \delta}^I}_J}}}} = {\left[\begin{matrix}  {{{ n}_a}} {{{ v}^a}} &  {{h}} {{{ n}_j}} \\  {\frac{1}{h}}{({-{{{\gamma}} \cdot {{{ n}^i}} {{({{H} - {h}})}}}})} &  {{{ n}_a}} {{{ v}^a}} {{{{ \delta}^i}_j}}\end{matrix}\right]}$
<br>
${{{ A}^I}_J} = {\left[\begin{matrix}  0 &  {{h}} {{{ n}_j}} \\  {\frac{1}{h}}{({-{{{\gamma}} \cdot {{{ n}^i}} {{({{H} - {h}})}}}})} &  0\end{matrix}\right]}$
<br>
${{{ A}^I}_J} = {\left[\begin{matrix}  0 &  {{h}} {{{ n}_j}} \\  {\frac{1}{h}}{({{{\eta}} \cdot {{\gamma}} \cdot {{{ n}^i}}})} &  0\end{matrix}\right]}$
<br>

<br>
Acoustic matrix, expanded:
<br>
${{{ A}^I}_J} = {\left[\begin{matrix}  0 &  {{h}} {{{ n}_1}} &  {{h}} {{{ n}_2}} &  {{h}} {{{ n}_3}} \\  {\frac{1}{h}}{({{{\eta}} \cdot {{\gamma}} \cdot {{{ n}^1}}})} &  0 &  0 &  0 \\  {\frac{1}{h}}{({{{\eta}} \cdot {{\gamma}} \cdot {{{ n}^2}}})} &  0 &  0 &  0 \\  {\frac{1}{h}}{({{{\eta}} \cdot {{\gamma}} \cdot {{{ n}^3}}})} &  0 &  0 &  0\end{matrix}\right]}$
<br>

<br>
Acoustic matrix eigen-decomposition:
<br>
${{|n|}^{2}} = {{{{{ n}^1}} {{{ n}_1}}} + {{{{ n}^2}} {{{ n}_2}}} + {{{{ n}^3}} {{{ n}_3}}}}$
<br>

<br>
${{{ A}^I}_J} = {{{{{ {(R_A)}}^I}_M}} {{{{ {(\Lambda_A)}}^M}_N}} {{{{ {(L_A)}}^N}_J}}}$
<br>
${{{ A}^I}_J} = { {\left[\begin{matrix}  \frac{{{h}} {{|n|}}}{{{c}} {{{ n}^3}}} &  \frac{-{{{h}} {{|n|}}}}{{{c}} {{{ n}^3}}} &  0 &  0 \\  \frac{{ n}^1}{{ n}^3} &  \frac{{ n}^1}{{ n}^3} &  \frac{-{{ n}_2}}{{ n}_1} &  \frac{-{{ n}_3}}{{ n}_1} \\  \frac{{ n}^2}{{ n}^3} &  \frac{{ n}^2}{{ n}^3} &  1 &  0 \\  1 &  1 &  0 &  1\end{matrix}\right]}  {\left[\begin{matrix}  {{c}} {{|n|}} &  0 &  0 &  0 \\  0 &  -{{{c}} {{|n|}}} &  0 &  0 \\  0 &  0 &  0 &  0 \\  0 &  0 &  0 &  0\end{matrix}\right]}  {\left[\begin{matrix}  \frac{{{c}} {{{ n}^3}}}{{{2}} {{h}} {{|n|}}} &  \frac{{{{ n}_1}} {{{ n}^3}}}{{{2}} {{{|n|}^{2}}}} &  \frac{{{{ n}_2}} {{{ n}^3}}}{{{2}} {{{|n|}^{2}}}} &  \frac{{{{ n}_3}} {{{ n}^3}}}{{{2}} {{{|n|}^{2}}}} \\  \frac{-{{{c}} {{{ n}^3}}}}{{{2}} {{h}} {{|n|}}} &  \frac{{{{ n}_1}} {{{ n}^3}}}{{{2}} {{{|n|}^{2}}}} &  \frac{{{{ n}_2}} {{{ n}^3}}}{{{2}} {{{|n|}^{2}}}} &  \frac{{{{ n}^3}} {{{ n}_3}}}{{{2}} {{{|n|}^{2}}}} \\  0 &  \frac{-{{{{ n}_1}} {{{ n}^2}}}}{{|n|}^{2}} &  \frac{-{({{{{{ n}_2}} {{{ n}^2}}} - {{|n|}^{2}}})}}{{|n|}^{2}} &  \frac{-{{{{ n}^2}} {{{ n}_3}}}}{{|n|}^{2}} \\  0 &  \frac{-{{{{ n}_1}} {{{ n}^3}}}}{{|n|}^{2}} &  \frac{-{{{{ n}_2}} {{{ n}^3}}}}{{|n|}^{2}} &  \frac{-{({{{{{ n}_3}} {{{ n}^3}}} - {{|n|}^{2}}})}}{{|n|}^{2}}\end{matrix}\right]}}$
<br>
scale by:	$\left[\begin{matrix}  { n}^3 &  0 &  0 &  0 \\  0 &  { n}^3 &  0 &  0 \\  0 &  0 &  { n}_1 &  0 \\  0 &  0 &  0 &  { n}_1\end{matrix}\right]$	, permute by:	$\left[\begin{matrix}  0 &  0 &  0 &  1 \\  1 &  0 &  0 &  0 \\  0 &  1 &  0 &  0 \\  0 &  0 &  1 &  0\end{matrix}\right]$
<br>
${{{ A}^I}_J} = { {\left[\begin{matrix}  {\frac{1}{c}}{({-{{{h}} {{|n|}}}})} &  0 &  0 &  {\frac{1}{c}}{({{{h}} {{|n|}}})} \\  { n}^1 &  -{{ n}_2} &  -{{ n}_3} &  { n}^1 \\  { n}^2 &  { n}_1 &  0 &  { n}^2 \\  { n}^3 &  0 &  { n}_1 &  { n}^3\end{matrix}\right]}  {\left[\begin{matrix}  -{{{c}} {{|n|}}} &  0 &  0 &  0 \\  0 &  0 &  0 &  0 \\  0 &  0 &  0 &  0 \\  0 &  0 &  0 &  {{c}} {{|n|}}\end{matrix}\right]}  {\left[\begin{matrix}  \frac{-{c}}{{{2}} {{h}} {{|n|}}} &  \frac{{ n}_1}{{{2}} {{{|n|}^{2}}}} &  \frac{{ n}_2}{{{2}} {{{|n|}^{2}}}} &  \frac{{ n}_3}{{{2}} {{{|n|}^{2}}}} \\  0 &  \frac{-{{ n}^2}}{{|n|}^{2}} &  \frac{-{({{{{{ n}_2}} {{{ n}^2}}} - {{|n|}^{2}}})}}{{{{ n}_1}} {{{|n|}^{2}}}} &  \frac{-{{{{ n}^2}} {{{ n}_3}}}}{{{{ n}_1}} {{{|n|}^{2}}}} \\  0 &  \frac{-{{ n}^3}}{{|n|}^{2}} &  \frac{-{{{{ n}_2}} {{{ n}^3}}}}{{{{ n}_1}} {{{|n|}^{2}}}} &  \frac{-{({{{{{ n}_3}} {{{ n}^3}}} - {{|n|}^{2}}})}}{{{{ n}_1}} {{{|n|}^{2}}}} \\  \frac{c}{{{2}} {{h}} {{|n|}}} &  \frac{{ n}_1}{{{2}} {{{|n|}^{2}}}} &  \frac{{ n}_2}{{{2}} {{{|n|}^{2}}}} &  \frac{{ n}_3}{{{2}} {{{|n|}^{2}}}}\end{matrix}\right]}}$
<br>

<br>
Replace $n \times e_x$ and $n \times e_y$ with $n_2, n_3$:
<br>
${ {\left[\begin{matrix}  { n}_1 &  { n}_2 &  { n}_3 \\  { {(n_2)}}_1 &  { {(n_2)}}_2 &  { {(n_2)}}_3 \\  { {(n_3)}}_1 &  { {(n_3)}}_2 &  { {(n_3)}}_3\end{matrix}\right]}  {\left[\begin{matrix}  { n}^1 &  { {(n_2)}}^1 &  { {(n_3)}}^1 \\  { n}^2 &  { {(n_2)}}^2 &  { {(n_3)}}^2 \\  { n}^3 &  { {(n_2)}}^3 &  { {(n_3)}}^3\end{matrix}\right]}} = {\left[\begin{matrix}  {|n|}^{2} &  0 &  0 \\  0 &  {|n|}^{2} &  0 \\  0 &  0 &  {|n|}^{2}\end{matrix}\right]}$
<br>
${{{ A}^I}_J} = { {\left[\begin{matrix}  {\frac{1}{c}}{({-{{{h}} {{|n|}}}})} &  0 &  0 &  {\frac{1}{c}}{({{{h}} {{|n|}}})} \\  { n}^1 &  { {(n_2)}}^1 &  { {(n_3)}}^1 &  { n}^1 \\  { n}^2 &  { {(n_2)}}^2 &  { {(n_3)}}^2 &  { n}^2 \\  { n}^3 &  { {(n_2)}}^3 &  { {(n_3)}}^3 &  { n}^3\end{matrix}\right]}  {\left[\begin{matrix}  -{{{c}} {{|n|}}} &  0 &  0 &  0 \\  0 &  0 &  0 &  0 \\  0 &  0 &  0 &  0 \\  0 &  0 &  0 &  {{c}} {{|n|}}\end{matrix}\right]}  {\left[\begin{matrix}  \frac{-{c}}{{{2}} {{h}} {{|n|}}} &  \frac{{ n}_1}{{{2}} {{{|n|}^{2}}}} &  \frac{{ n}_2}{{{2}} {{{|n|}^{2}}}} &  \frac{{ n}_3}{{{2}} {{{|n|}^{2}}}} \\  0 &  \frac{{ {(n_2)}}_1}{{|n|}^{2}} &  \frac{{ {(n_2)}}_2}{{|n|}^{2}} &  \frac{{ {(n_2)}}_3}{{|n|}^{2}} \\  0 &  \frac{{ {(n_3)}}_1}{{|n|}^{2}} &  \frac{{ {(n_3)}}_2}{{|n|}^{2}} &  \frac{{ {(n_3)}}_3}{{|n|}^{2}} \\  \frac{c}{{{2}} {{h}} {{|n|}}} &  \frac{{ n}_1}{{{2}} {{{|n|}^{2}}}} &  \frac{{ n}_2}{{{2}} {{{|n|}^{2}}}} &  \frac{{ n}_3}{{{2}} {{{|n|}^{2}}}}\end{matrix}\right]}}$
<br>

<br>
Acoustic matrix, reconstructed from eigen-decomposition:
<br>
${{{ A}^I}_J} = {\left[\begin{matrix}  0 &  {{h}} {{{ n}_1}} &  {{h}} {{{ n}_2}} &  {{h}} {{{ n}_3}} \\  {\frac{1}{h}}{({{{\eta}} \cdot {{\gamma}} \cdot {{{ n}^1}}})} &  0 &  0 &  0 \\  {\frac{1}{h}}{({{{\eta}} \cdot {{\gamma}} \cdot {{{ n}^2}}})} &  0 &  0 &  0 \\  {\frac{1}{h}}{({{{\eta}} \cdot {{\gamma}} \cdot {{{ n}^3}}})} &  0 &  0 &  0\end{matrix}\right]}$
<br>

<br>
Orthogonality of left and right eigenvectors:
<br>
$\left[\begin{matrix}  1 &  0 &  0 &  0 \\  0 &  1 &  0 &  0 \\  0 &  0 &  1 &  0 \\  0 &  0 &  0 &  1\end{matrix}\right]$
<br>

<br>
$A$'s eigensystem is $R_A \Lambda_A L_A$.<br>
$A + v I$'s eigensystem is $R_A \Lambda_A L_A + v I 
	= R_A \Lambda_A L_A + v R_A L_A 
	= R_A (\Lambda_A + v I) L_A$
.<br>
$\frac{\partial W}{\partial U} \cdot \frac{\partial F}{\partial W} = A + v I$<br>
$\frac{\partial F}{\partial U} = \frac{\partial U}{\partial W} \cdot \frac{\partial W}{\partial U} \cdot \frac{\partial F}{\partial W} \cdot \frac{\partial W}{\partial U} 
	= \frac{\partial U}{\partial W} \cdot (A + v I) \cdot \frac{\partial W}{\partial U}
	= \frac{\partial U}{\partial W} \cdot R_A (\Lambda_A + v I) L_A \cdot \frac{\partial W}{\partial U}$.<br>
Let $R_F = \frac{\partial U}{\partial W} \cdot R_A,
	\Lambda_F = \Lambda_A + v I,
	L_F = L_A \cdot \frac{\partial W}{\partial U}$.<br>
$\frac{\partial F}{\partial U} = R_F \Lambda_F L_F$.<br>


<br>
Flux Jacobian with respect to conserved variables:
<br>
${\frac{\partial { F}^I}{\partial { U}^J}} = {{{\frac{\partial { U}^I}{\partial { W}^K}}} {{\frac{\partial { W}^K}{\partial { U}^L}}} {{\frac{\partial { F}^L}{\partial { W}^M}}} {{\frac{\partial { W}^M}{\partial { U}^J}}}}$
<br>

<br>
${{R_F}} = { {\left[\begin{matrix}  1 &  0 &  0 &  0 \\  { v}^1 &  h &  0 &  0 \\  { v}^2 &  0 &  h &  0 \\  { v}^3 &  0 &  0 &  h\end{matrix}\right]}  {\left[\begin{matrix}  {\frac{1}{c}}{({-{{{h}} {{|n|}}}})} &  0 &  0 &  {\frac{1}{c}}{({{{h}} {{|n|}}})} \\  { n}^1 &  { {(n_2)}}^1 &  { {(n_3)}}^1 &  { n}^1 \\  { n}^2 &  { {(n_2)}}^2 &  { {(n_3)}}^2 &  { n}^2 \\  { n}^3 &  { {(n_2)}}^3 &  { {(n_3)}}^3 &  { n}^3\end{matrix}\right]}}$
<br>
${{R_F}} = {\left[\begin{matrix}  {{-1}} {{h}} {{|n|}} \cdot {{\frac{1}{c}}} &  0 &  0 &  {{h}} {{|n|}} \cdot {{\frac{1}{c}}} \\  {{{h}} {{{ n}^1}}} + {{{-1}} {{h}} {{|n|}} \cdot {{{ v}^1}} {{\frac{1}{c}}}} &  {{h}} {{{ {(n_2)}}^1}} &  {{h}} {{{ {(n_3)}}^1}} &  {{{h}} {{{ n}^1}}} + {{{h}} {{|n|}} \cdot {{{ v}^1}} {{\frac{1}{c}}}} \\  {{{h}} {{{ n}^2}}} + {{{-1}} {{h}} {{|n|}} \cdot {{{ v}^2}} {{\frac{1}{c}}}} &  {{h}} {{{ {(n_2)}}^2}} &  {{h}} {{{ {(n_3)}}^2}} &  {{{h}} {{{ n}^2}}} + {{{h}} {{|n|}} \cdot {{{ v}^2}} {{\frac{1}{c}}}} \\  {{{h}} {{{ n}^3}}} + {{{-1}} {{h}} {{|n|}} \cdot {{{ v}^3}} {{\frac{1}{c}}}} &  {{h}} {{{ {(n_2)}}^3}} &  {{h}} {{{ {(n_3)}}^3}} &  {{{h}} {{{ n}^3}}} + {{{h}} {{|n|}} \cdot {{{ v}^3}} {{\frac{1}{c}}}}\end{matrix}\right]}$
<br>
${{L_F}} = { {\left[\begin{matrix}  \frac{-{c}}{{{2}} {{h}} {{|n|}}} &  \frac{{ n}_1}{{{2}} {{{|n|}^{2}}}} &  \frac{{ n}_2}{{{2}} {{{|n|}^{2}}}} &  \frac{{ n}_3}{{{2}} {{{|n|}^{2}}}} \\  0 &  \frac{{ {(n_2)}}_1}{{|n|}^{2}} &  \frac{{ {(n_2)}}_2}{{|n|}^{2}} &  \frac{{ {(n_2)}}_3}{{|n|}^{2}} \\  0 &  \frac{{ {(n_3)}}_1}{{|n|}^{2}} &  \frac{{ {(n_3)}}_2}{{|n|}^{2}} &  \frac{{ {(n_3)}}_3}{{|n|}^{2}} \\  \frac{c}{{{2}} {{h}} {{|n|}}} &  \frac{{ n}_1}{{{2}} {{{|n|}^{2}}}} &  \frac{{ n}_2}{{{2}} {{{|n|}^{2}}}} &  \frac{{ n}_3}{{{2}} {{{|n|}^{2}}}}\end{matrix}\right]}  {\left[\begin{matrix}  1 &  0 &  0 &  0 \\  {\frac{1}{h}}{({-{{ v}^1}})} &  \frac{1}{h} &  0 &  0 \\  {\frac{1}{h}}{({-{{ v}^2}})} &  0 &  \frac{1}{h} &  0 \\  {\frac{1}{h}}{({-{{ v}^3}})} &  0 &  0 &  \frac{1}{h}\end{matrix}\right]}}$
<br>
${{L_F}} = {\left[\begin{matrix}  {{{-1}} \cdot {{\frac{1}{2}}} {{{ n}_k}} {{{ v}^k}} {{\frac{1}{h}}} {{\frac{1}{{|n|}^{2}}}}} + {{{-1}} \cdot {{\frac{1}{2}}} {{c}} {{\frac{1}{h}}} {{\frac{1}{|n|}}}} &  {{\frac{1}{2}}} {{{ n}_1}} {{\frac{1}{h}}} {{\frac{1}{{|n|}^{2}}}} &  {{\frac{1}{2}}} {{{ n}_2}} {{\frac{1}{h}}} {{\frac{1}{{|n|}^{2}}}} &  {{\frac{1}{2}}} {{{ n}_3}} {{\frac{1}{h}}} {{\frac{1}{{|n|}^{2}}}} \\  {{{-1}} {{{ {(n_2)}}_1}} {{{ v}^1}} {{\frac{1}{h}}} {{\frac{1}{{|n|}^{2}}}}} + {{{-1}} {{{ {(n_2)}}_2}} {{{ v}^2}} {{\frac{1}{h}}} {{\frac{1}{{|n|}^{2}}}}} + {{{-1}} {{{ {(n_2)}}_3}} {{{ v}^3}} {{\frac{1}{h}}} {{\frac{1}{{|n|}^{2}}}}} &  {{{ {(n_2)}}_1}} {{\frac{1}{h}}} {{\frac{1}{{|n|}^{2}}}} &  {{{ {(n_2)}}_2}} {{\frac{1}{h}}} {{\frac{1}{{|n|}^{2}}}} &  {{{ {(n_2)}}_3}} {{\frac{1}{h}}} {{\frac{1}{{|n|}^{2}}}} \\  {{{-1}} {{{ {(n_3)}}_1}} {{{ v}^1}} {{\frac{1}{h}}} {{\frac{1}{{|n|}^{2}}}}} + {{{-1}} {{{ {(n_3)}}_2}} {{{ v}^2}} {{\frac{1}{h}}} {{\frac{1}{{|n|}^{2}}}}} + {{{-1}} {{{ {(n_3)}}_3}} {{{ v}^3}} {{\frac{1}{h}}} {{\frac{1}{{|n|}^{2}}}}} &  {{{ {(n_3)}}_1}} {{\frac{1}{h}}} {{\frac{1}{{|n|}^{2}}}} &  {{{ {(n_3)}}_2}} {{\frac{1}{h}}} {{\frac{1}{{|n|}^{2}}}} &  {{{ {(n_3)}}_3}} {{\frac{1}{h}}} {{\frac{1}{{|n|}^{2}}}} \\  {{{-1}} \cdot {{\frac{1}{2}}} {{{ n}_k}} {{{ v}^k}} {{\frac{1}{h}}} {{\frac{1}{{|n|}^{2}}}}} + {{{\frac{1}{2}}} {{c}} {{\frac{1}{h}}} {{\frac{1}{|n|}}}} &  {{\frac{1}{2}}} {{{ n}_1}} {{\frac{1}{h}}} {{\frac{1}{{|n|}^{2}}}} &  {{\frac{1}{2}}} {{{ n}_2}} {{\frac{1}{h}}} {{\frac{1}{{|n|}^{2}}}} &  {{\frac{1}{2}}} {{{ n}_3}} {{\frac{1}{h}}} {{\frac{1}{{|n|}^{2}}}}\end{matrix}\right]}$
<br>

<br>
eigensystem transforms applied to vectors:
<br>
${{{{L_F}}} \cdot {{X}}} = {\left[\begin{matrix}  \frac{-{({{{{{X^0}}} \cdot {{{ n}_k}} {{{ v}^k}}} + {{{{{{{X^0}}} \cdot {{c}} {{|n|}}} - {{{{X^1}}} \cdot {{{ n}_1}}}} - {{{{X^2}}} \cdot {{{ n}_2}}}} - {{{{X^3}}} \cdot {{{ n}_3}}}}})}}{{{2}} {{h}} {{{|n|}^{2}}}} \\  \frac{-{({{{{{X^0}}} \cdot {{{ {(n_2)}}_1}} {{{ v}^1}}} + {{{{X^0}}} \cdot {{{ {(n_2)}}_2}} {{{ v}^2}}} + {{{{{{{X^0}}} \cdot {{{ {(n_2)}}_3}} {{{ v}^3}}} - {{{{X^1}}} \cdot {{{ {(n_2)}}_1}}}} - {{{{X^2}}} \cdot {{{ {(n_2)}}_2}}}} - {{{{X^3}}} \cdot {{{ {(n_2)}}_3}}}}})}}{{{h}} {{{|n|}^{2}}}} \\  \frac{-{({{{{{X^0}}} \cdot {{{ {(n_3)}}_1}} {{{ v}^1}}} + {{{{X^0}}} \cdot {{{ {(n_3)}}_2}} {{{ v}^2}}} + {{{{{{{X^0}}} \cdot {{{ {(n_3)}}_3}} {{{ v}^3}}} - {{{{X^1}}} \cdot {{{ {(n_3)}}_1}}}} - {{{{X^2}}} \cdot {{{ {(n_3)}}_2}}}} - {{{{X^3}}} \cdot {{{ {(n_3)}}_3}}}}})}}{{{h}} {{{|n|}^{2}}}} \\  \frac{-{({{{{{{{{X^0}}} \cdot {{{ n}_k}} {{{ v}^k}}} - {{{{X^0}}} \cdot {{c}} {{|n|}}}} - {{{{X^1}}} \cdot {{{ n}_1}}}} - {{{{X^2}}} \cdot {{{ n}_2}}}} - {{{{X^3}}} \cdot {{{ n}_3}}}})}}{{{2}} {{h}} {{{|n|}^{2}}}}\end{matrix}\right]}$
<br>

<br>
${{{{R_F}}} \cdot {{X}}} = {\left[\begin{matrix}  {\frac{1}{c}}{({-{{{h}} {{|n|}} \cdot {{({{{X^0}} - {{X^3}}})}}}})} \\  {\frac{1}{c}}{({{{h}} {{({{{{{{X^0}}} \cdot {{c}} {{{ n}^1}}} - {{{{X^0}}} \cdot {{|n|}} \cdot {{{ v}^1}}}} + {{{{X^1}}} \cdot {{c}} {{{ {(n_2)}}^1}}} + {{{{X^2}}} \cdot {{c}} {{{ {(n_3)}}^1}}} + {{{{X^3}}} \cdot {{c}} {{{ n}^1}}} + {{{{X^3}}} \cdot {{|n|}} \cdot {{{ v}^1}}}})}}})} \\  {\frac{1}{c}}{({{{h}} {{({{{{{{X^0}}} \cdot {{c}} {{{ n}^2}}} - {{{{X^0}}} \cdot {{|n|}} \cdot {{{ v}^2}}}} + {{{{X^1}}} \cdot {{c}} {{{ {(n_2)}}^2}}} + {{{{X^2}}} \cdot {{c}} {{{ {(n_3)}}^2}}} + {{{{X^3}}} \cdot {{c}} {{{ n}^2}}} + {{{{X^3}}} \cdot {{|n|}} \cdot {{{ v}^2}}}})}}})} \\  {\frac{1}{c}}{({{{h}} {{({{{{{{X^0}}} \cdot {{c}} {{{ n}^3}}} - {{{{X^0}}} \cdot {{|n|}} \cdot {{{ v}^3}}}} + {{{{X^1}}} \cdot {{c}} {{{ {(n_2)}}^3}}} + {{{{X^2}}} \cdot {{c}} {{{ {(n_3)}}^3}}} + {{{{X^3}}} \cdot {{c}} {{{ n}^3}}} + {{{{X^3}}} \cdot {{|n|}} \cdot {{{ v}^3}}}})}}})}\end{matrix}\right]}$
<br>

<br>
${{{2}} {{h}} {{{|n|}^{2}}} {{{L_F}}} \cdot {{X}}} = {\left[\begin{matrix}  -{({{{{{X^0}}} \cdot {{{ n}_k}} {{{ v}^k}}} + {{{{{{{X^0}}} \cdot {{c}} {{|n|}}} - {{{{X^1}}} \cdot {{{ n}_1}}}} - {{{{X^2}}} \cdot {{{ n}_2}}}} - {{{{X^3}}} \cdot {{{ n}_3}}}}})} \\  -{{{2}} {{({{{{{X^0}}} \cdot {{{ {(n_2)}}_1}} {{{ v}^1}}} + {{{{X^0}}} \cdot {{{ {(n_2)}}_2}} {{{ v}^2}}} + {{{{{{{X^0}}} \cdot {{{ {(n_2)}}_3}} {{{ v}^3}}} - {{{{X^1}}} \cdot {{{ {(n_2)}}_1}}}} - {{{{X^2}}} \cdot {{{ {(n_2)}}_2}}}} - {{{{X^3}}} \cdot {{{ {(n_2)}}_3}}}}})}}} \\  -{{{2}} {{({{{{{X^0}}} \cdot {{{ {(n_3)}}_1}} {{{ v}^1}}} + {{{{X^0}}} \cdot {{{ {(n_3)}}_2}} {{{ v}^2}}} + {{{{{{{X^0}}} \cdot {{{ {(n_3)}}_3}} {{{ v}^3}}} - {{{{X^1}}} \cdot {{{ {(n_3)}}_1}}}} - {{{{X^2}}} \cdot {{{ {(n_3)}}_2}}}} - {{{{X^3}}} \cdot {{{ {(n_3)}}_3}}}}})}}} \\  -{({{{{{{{{X^0}}} \cdot {{{ n}_k}} {{{ v}^k}}} - {{{{X^0}}} \cdot {{c}} {{|n|}}}} - {{{{X^1}}} \cdot {{{ n}_1}}}} - {{{{X^2}}} \cdot {{{ n}_2}}}} - {{{{X^3}}} \cdot {{{ n}_3}}}})}\end{matrix}\right]}$
<br>

<br>
${{{c}} {{{R_F}}} \cdot {{X}}} = {\left[\begin{matrix}  -{{{h}} {{|n|}} \cdot {{({{{X^0}} - {{X^3}}})}}} \\  {{h}} {{({{{{{{X^0}}} \cdot {{c}} {{{ n}^1}}} - {{{{X^0}}} \cdot {{|n|}} \cdot {{{ v}^1}}}} + {{{{X^1}}} \cdot {{c}} {{{ {(n_2)}}^1}}} + {{{{X^2}}} \cdot {{c}} {{{ {(n_3)}}^1}}} + {{{{X^3}}} \cdot {{c}} {{{ n}^1}}} + {{{{X^3}}} \cdot {{|n|}} \cdot {{{ v}^1}}}})}} \\  {{h}} {{({{{{{{X^0}}} \cdot {{c}} {{{ n}^2}}} - {{{{X^0}}} \cdot {{|n|}} \cdot {{{ v}^2}}}} + {{{{X^1}}} \cdot {{c}} {{{ {(n_2)}}^2}}} + {{{{X^2}}} \cdot {{c}} {{{ {(n_3)}}^2}}} + {{{{X^3}}} \cdot {{c}} {{{ n}^2}}} + {{{{X^3}}} \cdot {{|n|}} \cdot {{{ v}^2}}}})}} \\  {{h}} {{({{{{{{X^0}}} \cdot {{c}} {{{ n}^3}}} - {{{{X^0}}} \cdot {{|n|}} \cdot {{{ v}^3}}}} + {{{{X^1}}} \cdot {{c}} {{{ {(n_2)}}^3}}} + {{{{X^2}}} \cdot {{c}} {{{ {(n_3)}}^3}}} + {{{{X^3}}} \cdot {{c}} {{{ n}^3}}} + {{{{X^3}}} \cdot {{|n|}} \cdot {{{ v}^3}}}})}}\end{matrix}\right]}$
<br>

<br>
${{{\frac{\partial { F}^I}{\partial { U}^J}}} {{X}}} = {\left[\begin{matrix}  {{{{X^1}}} \cdot {{{ n}_1}}} + {{{{X^2}}} \cdot {{{ n}_2}}} + {{{{X^3}}} \cdot {{{ n}_3}}} \\  -{({{{{H}} {{{X^0}}} \cdot {{\gamma}} \cdot {{{ n}^1}}} + {{{{{{{{{X^0}}} \cdot {{{ n}_k}} {{{ v}^1}} {{{ v}^k}}} - {{{{X^0}}} \cdot {{\gamma}} \cdot {{h}} {{{ n}^1}}}} - {{{{X^1}}} \cdot {{{ n}_1}} {{{ v}^1}}}} - {{{{X^1}}} \cdot {{{ n}_k}} {{{ v}^k}}}} - {{{{X^2}}} \cdot {{{ n}_2}} {{{ v}^1}}}} - {{{{X^3}}} \cdot {{{ n}_3}} {{{ v}^1}}}}})} \\  -{({{{{H}} {{{X^0}}} \cdot {{\gamma}} \cdot {{{ n}^2}}} + {{{{{{{{{X^0}}} \cdot {{{ n}_k}} {{{ v}^2}} {{{ v}^k}}} - {{{{X^0}}} \cdot {{\gamma}} \cdot {{h}} {{{ n}^2}}}} - {{{{X^1}}} \cdot {{{ n}_1}} {{{ v}^2}}}} - {{{{X^2}}} \cdot {{{ n}_2}} {{{ v}^2}}}} - {{{{X^2}}} \cdot {{{ n}_k}} {{{ v}^k}}}} - {{{{X^3}}} \cdot {{{ n}_3}} {{{ v}^2}}}}})} \\  -{({{{{H}} {{{X^0}}} \cdot {{\gamma}} \cdot {{{ n}^3}}} + {{{{{{{{{X^0}}} \cdot {{{ n}_k}} {{{ v}^3}} {{{ v}^k}}} - {{{{X^0}}} \cdot {{\gamma}} \cdot {{h}} {{{ n}^3}}}} - {{{{X^1}}} \cdot {{{ n}_1}} {{{ v}^3}}}} - {{{{X^2}}} \cdot {{{ n}_2}} {{{ v}^3}}}} - {{{{X^3}}} \cdot {{{ n}_3}} {{{ v}^3}}}} - {{{{X^3}}} \cdot {{{ n}_k}} {{{ v}^k}}}}})}\end{matrix}\right]}$
<br>

<br>
${{2}} {{h}} {{{|n|}^{2}}} {{{L_F}}} \cdot {{X}}$	as code:
<br>
<pre>
invDenom = 1. / (2. * (nLen * nLen) * (eig)->h);
real const tmp1 = (eig)->C * (X)->ptr[0];
real const tmp2 = nLen * tmp1;
real const tmp3 = nL.x * (X)->ptr[1];
real const tmp5 = nL.y * (X)->ptr[2];
real const tmp7 = nL.z * (X)->ptr[3];
real const tmp8 = v_n * (X)->ptr[0];
real const tmp12 = (eig)->v.x * (X)->ptr[0];
real const tmp13 = (eig)->v.y * (X)->ptr[0];
real const tmp14 = (eig)->v.z * (X)->ptr[0];
real const (result)->ptr[0] = invDenom * -(tmp8 + tmp2 - tmp3 - tmp5 - tmp7);
real const (result)->ptr[1] = invDenom * -2. * (n2L.z * tmp14 - n2L.x * (X)->ptr[1] - n2L.y * (X)->ptr[2] - n2L.z * (X)->ptr[3] + n2L.y * tmp13 + n2L.x * tmp12);
real const (result)->ptr[2] = invDenom * -2. * (n3L.z * tmp14 - n3L.x * (X)->ptr[1] - n3L.y * (X)->ptr[2] - n3L.z * (X)->ptr[3] + n3L.y * tmp13 + n3L.x * tmp12);
real const (result)->ptr[3] = invDenom * -(tmp8 - tmp2 - tmp3 - tmp5 - tmp7);
</pre>
<br>

<br>
${{{R_F}}} \cdot {{X}}$	as code:
<br>
<pre>
invDenom = 1. / (eig)->C;
real const tmp5 = (eig)->C * (X)->ptr[0];
real const tmp6 = nLen * (X)->ptr[0];
real const tmp9 = (eig)->C * (X)->ptr[1];
real const tmp10 = (eig)->C * (X)->ptr[2];
real const tmp11 = (eig)->C * (X)->ptr[3];
real const tmp12 = nLen * (X)->ptr[3];
real const tmp22 = invDenom * (eig)->h;
real const (result)->ptr[0] = invDenom * -nLen * (eig)->h * ((X)->ptr[0] - (X)->ptr[3]);
real const (result)->ptr[1] = tmp22 * ((eig)->v.x * tmp12 + nU.x * tmp11 + n3U.x * tmp10 + n2U.x * tmp9 + nU.x * tmp5 - (eig)->v.x * tmp6);
real const (result)->ptr[2] = tmp22 * ((eig)->v.y * tmp12 + nU.y * tmp11 + n3U.y * tmp10 + n2U.y * tmp9 + nU.y * tmp5 - (eig)->v.y * tmp6);
real const (result)->ptr[3] = tmp22 * ((eig)->v.z * tmp12 + nU.z * tmp11 + n3U.z * tmp10 + n2U.z * tmp9 + nU.z * tmp5 - (eig)->v.z * tmp6);
</pre>
<br>

<br>
${{\frac{\partial { F}^I}{\partial { U}^J}}} {{X}}$	as code:
<br>
<pre>
real const tmp5 = solver->gravity * (X)->ptr[0];
real const tmp7 = v_n * (X)->ptr[0];
real const tmp8 = (eig)->h * (X)->ptr[0];
real const tmp9 = solver->gravity * tmp8;
real const (result)->ptr[0] = nL.z * (X)->ptr[3] + nL.y * (X)->ptr[2] + nL.x * (X)->ptr[1];
real const (result)->ptr[1] = -((eig)->v.x * tmp7 - nU.x * tmp9 - nL.x * (eig)->v.x * (X)->ptr[1] - v_n * (X)->ptr[1] - nL.y * (eig)->v.x * (X)->ptr[2] - nL.z * (eig)->v.x * (X)->ptr[3] + H * nU.x * tmp5);
real const (result)->ptr[2] = -((eig)->v.y * tmp7 - nU.y * tmp9 - nL.x * (eig)->v.y * (X)->ptr[1] - nL.y * (eig)->v.y * (X)->ptr[2] - v_n * (X)->ptr[2] - nL.z * (eig)->v.y * (X)->ptr[3] + H * nU.y * tmp5);
real const (result)->ptr[3] = -((eig)->v.z * tmp7 - nU.z * tmp9 - nL.x * (eig)->v.z * (X)->ptr[1] - nL.y * (eig)->v.z * (X)->ptr[2] - nL.z * (eig)->v.z * (X)->ptr[3] - v_n * (X)->ptr[3] + H * nU.z * tmp5);
</pre>
<br>

<br>

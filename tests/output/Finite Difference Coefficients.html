<!doctype html>
<html>
	<head>
		<meta charset='utf-8'>
		<title>Finite Difference Coefficients</title>
		<script type='text/javascript' src='./tryToFindMathJax.js'></script>
	
		<style>
:root {
	--font-color: #000000;
	--bg-color: rgb(243,243,243);
}
[data-theme="dark"] {
	--font-color: #ffffff;
	--bg-color: #000000;
}

body {
	overflow : scroll;
	background : var(--bg-color);
	color : var(--font-color);
}

/* desktop chrome inputs have white background black font.  mobile chrome inputs have clear background black font. */
input {
	background : var(--bg-color);
	color : var(--font-color);
}
		</style>
		<script type='text/javascript'>
//https://stackoverflow.com/questions/56300132/how-to-override-css-prefers-color-scheme-setting
window.addEventListener('load', () => {
	let darkMode = false;
	if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
		darkMode = true;
	}
	if (darkMode) {
		document.documentElement.setAttribute('data-theme', 'dark');
	} else {
		document.documentElement.removeAttribute('data-theme', 'dark');
	}
});
		</script>


	</head>
	<body>

$f(x) = $ the function we are approximating the derivative of.
<br>
$\bar{x} =$ the point at which we are approximating the derivative.
<br>
h = the step size of our finite difference grid.
<br>
$y_k = f(\bar{x}_0 + k h) =$ the function, evaluated along our evenly spaced samples.
<br>
$p(x) = c_i x^i =$ the polynomial approximation of the derivative.
<br>

<br>
$A_{ij} = [ (\bar{x}_0 + i \cdot h)^{j-1} ]$
<br>
${\vec{y}} = {{{\mathbf{A}}} \cdot {{\vec{c}}}}$
<br>

<br>
${\vec{c}} = {{{{\mathbf{A}}^{-1}}} {{\vec{y}}}}$
<br>

<br>

<br>
<h3>Central Difference, 1st deriv</h3>
<br>
<h3>...2 order</h3>
<br>
${{\vec{c}} = {{{{\mathbf{A}}^{-1}}} {{{y_i}}}}} = {{{\left[\begin{array}{ccc} \frac{{{\bar{x}}} \cdot {{\left({{\bar{x}} + {h}}\right)}}}{{{2}} {{{h}^{2}}}}& \frac{{-{{\bar{x}}^{2}}} + {{h}^{2}}}{{h}^{2}}& \frac{{{\bar{x}}} \cdot {{\left({{\bar{x}}{-{h}}}\right)}}}{{{2}} {{{h}^{2}}}}\\ -{\frac{{h} + {{{2}} {{\bar{x}}}}}{{{2}} {{{h}^{2}}}}}& \frac{{{2}} {{\bar{x}}}}{{h}^{2}}& \frac{{h}{-{{{2}} {{\bar{x}}}}}}{{{2}} {{{h}^{2}}}}\\ \frac{1}{{{2}} {{{h}^{2}}}}& -{\frac{1}{{h}^{2}}}& \frac{1}{{{2}} {{{h}^{2}}}}\end{array}\right]}} {{\left[\begin{array}{c} {y_{1}}\\ {y_{2}}\\ {y_{3}}\end{array}\right]}}}$
<br>

<br>
${{p(x)} = {{{{x^j}}} \cdot {{{\mathbf{A}}^{-1}}} {{{y_i}}}}} = {{{\left[\begin{array}{ccc} 1& x& {x}^{2}\end{array}\right]}} {{\left[\begin{array}{ccc} \frac{{{\bar{x}}} \cdot {{\left({{\bar{x}} + {h}}\right)}}}{{{2}} {{{h}^{2}}}}& \frac{{-{{\bar{x}}^{2}}} + {{h}^{2}}}{{h}^{2}}& \frac{{{\bar{x}}} \cdot {{\left({{\bar{x}}{-{h}}}\right)}}}{{{2}} {{{h}^{2}}}}\\ -{\frac{{h} + {{{2}} {{\bar{x}}}}}{{{2}} {{{h}^{2}}}}}& \frac{{{2}} {{\bar{x}}}}{{h}^{2}}& \frac{{h}{-{{{2}} {{\bar{x}}}}}}{{{2}} {{{h}^{2}}}}\\ \frac{1}{{{2}} {{{h}^{2}}}}& -{\frac{1}{{h}^{2}}}& \frac{1}{{{2}} {{{h}^{2}}}}\end{array}\right]}} {{\left[\begin{array}{c} {y_{1}}\\ {y_{2}}\\ {y_{3}}\end{array}\right]}}}$
<br>

<br>
let	${\bar{x}} = {x}$
<br>
${\frac{\partial p(x)}{\partial x}} \approx {{{\frac{1}{h}}} {{{\frac{1}{2}}{\left({{-{{y_{1}}}} + {{y_{3}}}}\right)}}}}$
<br>

<br>
${\frac{\partial p(x)}{\partial x}} \approx {{{\frac{1}{h}}} {{\left[\begin{array}{ccc} -{\frac{1}{2}}& 0& \frac{1}{2}\end{array}\right]}} {{\left[\begin{array}{c} {y_{1}}\\ {y_{2}}\\ {y_{3}}\end{array}\right]}}}$
<br>
<h3>...4 order</h3>
<br>
${{\vec{c}} = {{{{\mathbf{A}}^{-1}}} {{{y_i}}}}} = {{{\left[\begin{array}{ccccc} \frac{{{{2}} {{{\bar{x}}^{3}}} {{{h}^{3}}}}{-{{{{\bar{x}}^{2}}} {{{h}^{4}}}}} + {{{{\bar{x}}^{4}}} {{{h}^{2}}}}{-{{{2}} {{\bar{x}}} \cdot {{{h}^{5}}}}}}{{{24}} {{{h}^{6}}}}& \frac{{-{{{{\bar{x}}^{3}}} {{{h}^{3}}}}}{-{{{{\bar{x}}^{4}}} {{{h}^{2}}}}} + {{{4}} {{\bar{x}}} \cdot {{{h}^{5}}}} + {{{4}} {{{\bar{x}}^{2}}} {{{h}^{4}}}}}{{{6}} {{{h}^{6}}}}& \frac{{{\bar{x}}^{4}}{-{{{5}} {{{\bar{x}}^{2}}} {{{h}^{2}}}}} + {{{4}} {{{h}^{4}}}}}{{{4}} {{{h}^{4}}}}& \frac{{{{{\bar{x}}^{3}}} {{{h}^{3}}}}{-{{{{\bar{x}}^{4}}} {{{h}^{2}}}}}{-{{{4}} {{\bar{x}}} \cdot {{{h}^{5}}}}} + {{{4}} {{{\bar{x}}^{2}}} {{{h}^{4}}}}}{{{6}} {{{h}^{6}}}}& \frac{{-{{{2}} {{{\bar{x}}^{3}}} {{{h}^{3}}}}}{-{{{{\bar{x}}^{2}}} {{{h}^{4}}}}} + {{{{\bar{x}}^{4}}} {{{h}^{2}}}} + {{{2}} {{\bar{x}}} \cdot {{{h}^{5}}}}}{{{24}} {{{h}^{6}}}}\\ \frac{{{h}^{3}}{-{{{2}} {{{\bar{x}}^{3}}}}} + {{{\bar{x}}} \cdot {{{h}^{2}}}}{-{{{3}} {{h}} {{{\bar{x}}^{2}}}}}}{{{12}} {{{h}^{4}}}}& \frac{{{{4}} {{{\bar{x}}^{3}}}}{-{{{4}} {{{h}^{3}}}}} + {{{3}} {{h}} {{{\bar{x}}^{2}}}}{-{{{8}} {{\bar{x}}} \cdot {{{h}^{2}}}}}}{{{6}} {{{h}^{4}}}}& \frac{{{\bar{x}}} \cdot {{\left({{-{{{2}} {{{\bar{x}}^{2}}}}} + {{{5}} {{{h}^{2}}}}}\right)}}}{{{2}} {{{h}^{4}}}}& \frac{{{{4}} {{{\bar{x}}^{3}}}} + {{{4}} {{{h}^{3}}}}{-{{{3}} {{h}} {{{\bar{x}}^{2}}}}}{-{{{8}} {{\bar{x}}} \cdot {{{h}^{2}}}}}}{{{6}} {{{h}^{4}}}}& \frac{{-{{h}^{3}}}{-{{{2}} {{{\bar{x}}^{3}}}}} + {{{\bar{x}}} \cdot {{{h}^{2}}}} + {{{3}} {{h}} {{{\bar{x}}^{2}}}}}{{{12}} {{{h}^{4}}}}\\ \frac{{-{{h}^{4}}} + {{{6}} {{{\bar{x}}^{2}}} {{{h}^{2}}}} + {{{6}} {{\bar{x}}} \cdot {{{h}^{3}}}}}{{{24}} {{{h}^{6}}}}& \frac{{{{4}} {{{h}^{4}}}}{-{{{6}} {{{\bar{x}}^{2}}} {{{h}^{2}}}}}{-{{{3}} {{\bar{x}}} \cdot {{{h}^{3}}}}}}{{{6}} {{{h}^{6}}}}& \frac{{-{{{5}} {{{h}^{4}}}}} + {{{6}} {{{\bar{x}}^{2}}} {{{h}^{2}}}}}{{{4}} {{{h}^{6}}}}& \frac{{{{4}} {{{h}^{4}}}}{-{{{6}} {{{\bar{x}}^{2}}} {{{h}^{2}}}}} + {{{3}} {{\bar{x}}} \cdot {{{h}^{3}}}}}{{{6}} {{{h}^{6}}}}& \frac{{-{{h}^{4}}} + {{{6}} {{{\bar{x}}^{2}}} {{{h}^{2}}}}{-{{{6}} {{\bar{x}}} \cdot {{{h}^{3}}}}}}{{{24}} {{{h}^{6}}}}\\ -{\frac{{h} + {{{2}} {{\bar{x}}}}}{{{12}} {{{h}^{4}}}}}& \frac{{h} + {{{4}} {{\bar{x}}}}}{{{6}} {{{h}^{4}}}}& -{\frac{\bar{x}}{{h}^{4}}}& \frac{{-{h}} + {{{4}} {{\bar{x}}}}}{{{6}} {{{h}^{4}}}}& \frac{{h}{-{{{2}} {{\bar{x}}}}}}{{{12}} {{{h}^{4}}}}\\ \frac{1}{{{24}} {{{h}^{4}}}}& -{\frac{1}{{{6}} {{{h}^{4}}}}}& \frac{1}{{{4}} {{{h}^{4}}}}& -{\frac{1}{{{6}} {{{h}^{4}}}}}& \frac{1}{{{24}} {{{h}^{4}}}}\end{array}\right]}} {{\left[\begin{array}{c} {y_{1}}\\ {y_{2}}\\ {y_{3}}\\ {y_{4}}\\ {y_{5}}\end{array}\right]}}}$
<br>

<br>
${{p(x)} = {{{{x^j}}} \cdot {{{\mathbf{A}}^{-1}}} {{{y_i}}}}} = {{{\left[\begin{array}{ccccc} 1& x& {x}^{2}& {x}^{3}& {x}^{4}\end{array}\right]}} {{\left[\begin{array}{ccccc} \frac{{{{2}} {{{\bar{x}}^{3}}} {{{h}^{3}}}}{-{{{{\bar{x}}^{2}}} {{{h}^{4}}}}} + {{{{\bar{x}}^{4}}} {{{h}^{2}}}}{-{{{2}} {{\bar{x}}} \cdot {{{h}^{5}}}}}}{{{24}} {{{h}^{6}}}}& \frac{{-{{{{\bar{x}}^{3}}} {{{h}^{3}}}}}{-{{{{\bar{x}}^{4}}} {{{h}^{2}}}}} + {{{4}} {{\bar{x}}} \cdot {{{h}^{5}}}} + {{{4}} {{{\bar{x}}^{2}}} {{{h}^{4}}}}}{{{6}} {{{h}^{6}}}}& \frac{{{\bar{x}}^{4}}{-{{{5}} {{{\bar{x}}^{2}}} {{{h}^{2}}}}} + {{{4}} {{{h}^{4}}}}}{{{4}} {{{h}^{4}}}}& \frac{{{{{\bar{x}}^{3}}} {{{h}^{3}}}}{-{{{{\bar{x}}^{4}}} {{{h}^{2}}}}}{-{{{4}} {{\bar{x}}} \cdot {{{h}^{5}}}}} + {{{4}} {{{\bar{x}}^{2}}} {{{h}^{4}}}}}{{{6}} {{{h}^{6}}}}& \frac{{-{{{2}} {{{\bar{x}}^{3}}} {{{h}^{3}}}}}{-{{{{\bar{x}}^{2}}} {{{h}^{4}}}}} + {{{{\bar{x}}^{4}}} {{{h}^{2}}}} + {{{2}} {{\bar{x}}} \cdot {{{h}^{5}}}}}{{{24}} {{{h}^{6}}}}\\ \frac{{{h}^{3}}{-{{{2}} {{{\bar{x}}^{3}}}}} + {{{\bar{x}}} \cdot {{{h}^{2}}}}{-{{{3}} {{h}} {{{\bar{x}}^{2}}}}}}{{{12}} {{{h}^{4}}}}& \frac{{{{4}} {{{\bar{x}}^{3}}}}{-{{{4}} {{{h}^{3}}}}} + {{{3}} {{h}} {{{\bar{x}}^{2}}}}{-{{{8}} {{\bar{x}}} \cdot {{{h}^{2}}}}}}{{{6}} {{{h}^{4}}}}& \frac{{{\bar{x}}} \cdot {{\left({{-{{{2}} {{{\bar{x}}^{2}}}}} + {{{5}} {{{h}^{2}}}}}\right)}}}{{{2}} {{{h}^{4}}}}& \frac{{{{4}} {{{\bar{x}}^{3}}}} + {{{4}} {{{h}^{3}}}}{-{{{3}} {{h}} {{{\bar{x}}^{2}}}}}{-{{{8}} {{\bar{x}}} \cdot {{{h}^{2}}}}}}{{{6}} {{{h}^{4}}}}& \frac{{-{{h}^{3}}}{-{{{2}} {{{\bar{x}}^{3}}}}} + {{{\bar{x}}} \cdot {{{h}^{2}}}} + {{{3}} {{h}} {{{\bar{x}}^{2}}}}}{{{12}} {{{h}^{4}}}}\\ \frac{{-{{h}^{4}}} + {{{6}} {{{\bar{x}}^{2}}} {{{h}^{2}}}} + {{{6}} {{\bar{x}}} \cdot {{{h}^{3}}}}}{{{24}} {{{h}^{6}}}}& \frac{{{{4}} {{{h}^{4}}}}{-{{{6}} {{{\bar{x}}^{2}}} {{{h}^{2}}}}}{-{{{3}} {{\bar{x}}} \cdot {{{h}^{3}}}}}}{{{6}} {{{h}^{6}}}}& \frac{{-{{{5}} {{{h}^{4}}}}} + {{{6}} {{{\bar{x}}^{2}}} {{{h}^{2}}}}}{{{4}} {{{h}^{6}}}}& \frac{{{{4}} {{{h}^{4}}}}{-{{{6}} {{{\bar{x}}^{2}}} {{{h}^{2}}}}} + {{{3}} {{\bar{x}}} \cdot {{{h}^{3}}}}}{{{6}} {{{h}^{6}}}}& \frac{{-{{h}^{4}}} + {{{6}} {{{\bar{x}}^{2}}} {{{h}^{2}}}}{-{{{6}} {{\bar{x}}} \cdot {{{h}^{3}}}}}}{{{24}} {{{h}^{6}}}}\\ -{\frac{{h} + {{{2}} {{\bar{x}}}}}{{{12}} {{{h}^{4}}}}}& \frac{{h} + {{{4}} {{\bar{x}}}}}{{{6}} {{{h}^{4}}}}& -{\frac{\bar{x}}{{h}^{4}}}& \frac{{-{h}} + {{{4}} {{\bar{x}}}}}{{{6}} {{{h}^{4}}}}& \frac{{h}{-{{{2}} {{\bar{x}}}}}}{{{12}} {{{h}^{4}}}}\\ \frac{1}{{{24}} {{{h}^{4}}}}& -{\frac{1}{{{6}} {{{h}^{4}}}}}& \frac{1}{{{4}} {{{h}^{4}}}}& -{\frac{1}{{{6}} {{{h}^{4}}}}}& \frac{1}{{{24}} {{{h}^{4}}}}\end{array}\right]}} {{\left[\begin{array}{c} {y_{1}}\\ {y_{2}}\\ {y_{3}}\\ {y_{4}}\\ {y_{5}}\end{array}\right]}}}$
<br>

<br>
let	${\bar{x}} = {x}$
<br>
${\frac{\partial p(x)}{\partial x}} \approx {{{\frac{1}{h}}} {{{\frac{1}{12}}{\left({{{y_{1}}}{-{{y_{5}}}}{-{{{8}} {{{y_{2}}}}}} + {{{8}} {{{y_{4}}}}}}\right)}}}}$
<br>

<br>
${\frac{\partial p(x)}{\partial x}} \approx {{{\frac{1}{h}}} {{\left[\begin{array}{ccccc} \frac{1}{12}& -{\frac{2}{3}}& 0& \frac{2}{3}& -{\frac{1}{12}}\end{array}\right]}} {{\left[\begin{array}{c} {y_{1}}\\ {y_{2}}\\ {y_{3}}\\ {y_{4}}\\ {y_{5}}\end{array}\right]}}}$
<br>
<h3>Numericaly:</h3>
<br>
<h3>...2 order</h3>
<br>
${A} = {\left[\begin{array}{ccc} 1& -1& 1\\ 1& 0& 0\\ 1& 1& 1\end{array}\right]}$
<br>

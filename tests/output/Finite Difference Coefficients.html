<!doctype html>
<html>
	<head>
		<meta charset='utf-8'>
		<title>Finite Difference Coefficients</title>
		<script type='text/javascript' src='./tryToFindMathJax.js'></script>
	
		<style>
:root {
	--font-color: #000000;
	--bg-color: rgb(243,243,243);
}
[data-theme="dark"] {
	--font-color: #ffffff;
	--bg-color: #000000;
}

body {
	overflow : scroll;
	background : var(--bg-color);
	color : var(--font-color);
}

/* desktop chrome inputs have white background black font.  mobile chrome inputs have clear background black font. */
input {
	background : var(--bg-color);
	color : var(--font-color);
}
		</style>
		<script type='text/javascript'>
//https://stackoverflow.com/questions/56300132/how-to-override-css-prefers-color-scheme-setting
window.addEventListener('load', () => {
	let darkMode = false;
	if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
		darkMode = true;
	}
	if (darkMode) {
		document.documentElement.setAttribute('data-theme', 'dark');
	} else {
		document.documentElement.removeAttribute('data-theme', 'dark');
	}
});
		</script>


	</head>
	<body>

$f(x) = $ the function we are approximating the derivative of.
<br>
$\bar{x} =$ the point at which we are approximating the derivative.
<br>
h = the step size of our finite difference grid.
<br>
$y_k = f(\bar{x}_0 + k h) =$ the function, evaluated along our evenly spaced samples.
<br>
$p(x) = c_i x^i =$ the polynomial approximation of the derivative.
<br>

<br>
$A_{ij} = [ (\bar{x}_0 + i \cdot h)^{j-1} ]$
<br>
${\vec{y}} = {{{\mathbf{A}}} \cdot {{\vec{c}}}}$
<br>

<br>
${\vec{c}} = {{{{\mathbf{A}}^{-1}}} {{\vec{y}}}}$
<br>

<br>

<br>
<h3>Central Difference, 1st deriv</h3>
<br>
<h3>...2 order</h3>
<br>
${{\vec{c}} = {{{{\mathbf{A}}^{-1}}} {{{y_i}}}}} = {{{\left[\begin{array}{ccc} \frac{{{\bar{x}}} \cdot {{\left({{\bar{x}} + {h}}\right)}}}{{{2}} {{{h}^{2}}}}& \frac{{-{{\bar{x}}^{2}}} + {{h}^{2}}}{{h}^{2}}& \frac{{{\bar{x}}} \cdot {{\left({{\bar{x}}{-{h}}}\right)}}}{{{2}} {{{h}^{2}}}}\\ -{\frac{{h} + {{{2}} {{\bar{x}}}}}{{{2}} {{{h}^{2}}}}}& \frac{{{2}} {{\bar{x}}}}{{h}^{2}}& \frac{{h}{-{{{2}} {{\bar{x}}}}}}{{{2}} {{{h}^{2}}}}\\ \frac{1}{{{2}} {{{h}^{2}}}}& -{\frac{1}{{h}^{2}}}& \frac{1}{{{2}} {{{h}^{2}}}}\end{array}\right]}} {{\left[\begin{array}{c} {y_{1}}\\ {y_{2}}\\ {y_{3}}\end{array}\right]}}}$
<br>

<br>
${{p(x)} = {{{{x^j}}} \cdot {{{\mathbf{A}}^{-1}}} {{{y_i}}}}} = {{{\left[\begin{array}{ccc} 1& x& {x}^{2}\end{array}\right]}} {{\left[\begin{array}{ccc} \frac{{{\bar{x}}} \cdot {{\left({{\bar{x}} + {h}}\right)}}}{{{2}} {{{h}^{2}}}}& \frac{{-{{\bar{x}}^{2}}} + {{h}^{2}}}{{h}^{2}}& \frac{{{\bar{x}}} \cdot {{\left({{\bar{x}}{-{h}}}\right)}}}{{{2}} {{{h}^{2}}}}\\ -{\frac{{h} + {{{2}} {{\bar{x}}}}}{{{2}} {{{h}^{2}}}}}& \frac{{{2}} {{\bar{x}}}}{{h}^{2}}& \frac{{h}{-{{{2}} {{\bar{x}}}}}}{{{2}} {{{h}^{2}}}}\\ \frac{1}{{{2}} {{{h}^{2}}}}& -{\frac{1}{{h}^{2}}}& \frac{1}{{{2}} {{{h}^{2}}}}\end{array}\right]}} {{\left[\begin{array}{c} {y_{1}}\\ {y_{2}}\\ {y_{3}}\end{array}\right]}}}$
<br>

<br>
let	${\bar{x}} = {x}$
<br>
${\frac{\partial p(x)}{\partial x}} \approx {{{\frac{1}{h}}} {{{\frac{1}{2}}{\left({{-{{y_{1}}}} + {{y_{3}}}}\right)}}}}$
<br>

<br>
${\frac{\partial p(x)}{\partial x}} \approx {{{\frac{1}{h}}} {{\left[\begin{array}{ccc} -{\frac{1}{2}}& 0& \frac{1}{2}\end{array}\right]}} {{\left[\begin{array}{c} {y_{1}}\\ {y_{2}}\\ {y_{3}}\end{array}\right]}}}$
<br>
<h3>...4 order</h3>
<br>
${{\vec{c}} = {{{{\mathbf{A}}^{-1}}} {{{y_i}}}}} = {{{\left[\begin{array}{ccccc} \frac{{{{2}} {{{\bar{x}}^{3}}} {{{h}^{3}}}}{-{{{{\bar{x}}^{2}}} {{{h}^{4}}}}} + {{{{\bar{x}}^{4}}} {{{h}^{2}}}}{-{{{2}} {{\bar{x}}} \cdot {{{h}^{5}}}}}}{{{24}} {{{h}^{6}}}}& \frac{{-{{{{\bar{x}}^{3}}} {{{h}^{3}}}}}{-{{{{\bar{x}}^{4}}} {{{h}^{2}}}}} + {{{4}} {{\bar{x}}} \cdot {{{h}^{5}}}} + {{{4}} {{{\bar{x}}^{2}}} {{{h}^{4}}}}}{{{6}} {{{h}^{6}}}}& \frac{{{\bar{x}}^{4}}{-{{{5}} {{{\bar{x}}^{2}}} {{{h}^{2}}}}} + {{{4}} {{{h}^{4}}}}}{{{4}} {{{h}^{4}}}}& \frac{{{{{\bar{x}}^{3}}} {{{h}^{3}}}}{-{{{{\bar{x}}^{4}}} {{{h}^{2}}}}}{-{{{4}} {{\bar{x}}} \cdot {{{h}^{5}}}}} + {{{4}} {{{\bar{x}}^{2}}} {{{h}^{4}}}}}{{{6}} {{{h}^{6}}}}& \frac{{-{{{2}} {{{\bar{x}}^{3}}} {{{h}^{3}}}}}{-{{{{\bar{x}}^{2}}} {{{h}^{4}}}}} + {{{{\bar{x}}^{4}}} {{{h}^{2}}}} + {{{2}} {{\bar{x}}} \cdot {{{h}^{5}}}}}{{{24}} {{{h}^{6}}}}\\ \frac{{{h}^{3}}{-{{{2}} {{{\bar{x}}^{3}}}}} + {{{\bar{x}}} \cdot {{{h}^{2}}}}{-{{{3}} {{h}} {{{\bar{x}}^{2}}}}}}{{{12}} {{{h}^{4}}}}& \frac{{{{4}} {{{\bar{x}}^{3}}}}{-{{{4}} {{{h}^{3}}}}} + {{{3}} {{h}} {{{\bar{x}}^{2}}}}{-{{{8}} {{\bar{x}}} \cdot {{{h}^{2}}}}}}{{{6}} {{{h}^{4}}}}& \frac{{{\bar{x}}} \cdot {{\left({{-{{{2}} {{{\bar{x}}^{2}}}}} + {{{5}} {{{h}^{2}}}}}\right)}}}{{{2}} {{{h}^{4}}}}& \frac{{{{4}} {{{\bar{x}}^{3}}}} + {{{4}} {{{h}^{3}}}}{-{{{3}} {{h}} {{{\bar{x}}^{2}}}}}{-{{{8}} {{\bar{x}}} \cdot {{{h}^{2}}}}}}{{{6}} {{{h}^{4}}}}& \frac{{-{{h}^{3}}}{-{{{2}} {{{\bar{x}}^{3}}}}} + {{{\bar{x}}} \cdot {{{h}^{2}}}} + {{{3}} {{h}} {{{\bar{x}}^{2}}}}}{{{12}} {{{h}^{4}}}}\\ \frac{{-{{h}^{4}}} + {{{6}} {{{\bar{x}}^{2}}} {{{h}^{2}}}} + {{{6}} {{\bar{x}}} \cdot {{{h}^{3}}}}}{{{24}} {{{h}^{6}}}}& \frac{{{{4}} {{{h}^{4}}}}{-{{{6}} {{{\bar{x}}^{2}}} {{{h}^{2}}}}}{-{{{3}} {{\bar{x}}} \cdot {{{h}^{3}}}}}}{{{6}} {{{h}^{6}}}}& \frac{{-{{{5}} {{{h}^{4}}}}} + {{{6}} {{{\bar{x}}^{2}}} {{{h}^{2}}}}}{{{4}} {{{h}^{6}}}}& \frac{{{{4}} {{{h}^{4}}}}{-{{{6}} {{{\bar{x}}^{2}}} {{{h}^{2}}}}} + {{{3}} {{\bar{x}}} \cdot {{{h}^{3}}}}}{{{6}} {{{h}^{6}}}}& \frac{{-{{h}^{4}}} + {{{6}} {{{\bar{x}}^{2}}} {{{h}^{2}}}}{-{{{6}} {{\bar{x}}} \cdot {{{h}^{3}}}}}}{{{24}} {{{h}^{6}}}}\\ -{\frac{{h} + {{{2}} {{\bar{x}}}}}{{{12}} {{{h}^{4}}}}}& \frac{{h} + {{{4}} {{\bar{x}}}}}{{{6}} {{{h}^{4}}}}& -{\frac{\bar{x}}{{h}^{4}}}& \frac{{-{h}} + {{{4}} {{\bar{x}}}}}{{{6}} {{{h}^{4}}}}& \frac{{h}{-{{{2}} {{\bar{x}}}}}}{{{12}} {{{h}^{4}}}}\\ \frac{1}{{{24}} {{{h}^{4}}}}& -{\frac{1}{{{6}} {{{h}^{4}}}}}& \frac{1}{{{4}} {{{h}^{4}}}}& -{\frac{1}{{{6}} {{{h}^{4}}}}}& \frac{1}{{{24}} {{{h}^{4}}}}\end{array}\right]}} {{\left[\begin{array}{c} {y_{1}}\\ {y_{2}}\\ {y_{3}}\\ {y_{4}}\\ {y_{5}}\end{array}\right]}}}$
<br>

<br>
${{p(x)} = {{{{x^j}}} \cdot {{{\mathbf{A}}^{-1}}} {{{y_i}}}}} = {{{\left[\begin{array}{ccccc} 1& x& {x}^{2}& {x}^{3}& {x}^{4}\end{array}\right]}} {{\left[\begin{array}{ccccc} \frac{{{{2}} {{{\bar{x}}^{3}}} {{{h}^{3}}}}{-{{{{\bar{x}}^{2}}} {{{h}^{4}}}}} + {{{{\bar{x}}^{4}}} {{{h}^{2}}}}{-{{{2}} {{\bar{x}}} \cdot {{{h}^{5}}}}}}{{{24}} {{{h}^{6}}}}& \frac{{-{{{{\bar{x}}^{3}}} {{{h}^{3}}}}}{-{{{{\bar{x}}^{4}}} {{{h}^{2}}}}} + {{{4}} {{\bar{x}}} \cdot {{{h}^{5}}}} + {{{4}} {{{\bar{x}}^{2}}} {{{h}^{4}}}}}{{{6}} {{{h}^{6}}}}& \frac{{{\bar{x}}^{4}}{-{{{5}} {{{\bar{x}}^{2}}} {{{h}^{2}}}}} + {{{4}} {{{h}^{4}}}}}{{{4}} {{{h}^{4}}}}& \frac{{{{{\bar{x}}^{3}}} {{{h}^{3}}}}{-{{{{\bar{x}}^{4}}} {{{h}^{2}}}}}{-{{{4}} {{\bar{x}}} \cdot {{{h}^{5}}}}} + {{{4}} {{{\bar{x}}^{2}}} {{{h}^{4}}}}}{{{6}} {{{h}^{6}}}}& \frac{{-{{{2}} {{{\bar{x}}^{3}}} {{{h}^{3}}}}}{-{{{{\bar{x}}^{2}}} {{{h}^{4}}}}} + {{{{\bar{x}}^{4}}} {{{h}^{2}}}} + {{{2}} {{\bar{x}}} \cdot {{{h}^{5}}}}}{{{24}} {{{h}^{6}}}}\\ \frac{{{h}^{3}}{-{{{2}} {{{\bar{x}}^{3}}}}} + {{{\bar{x}}} \cdot {{{h}^{2}}}}{-{{{3}} {{h}} {{{\bar{x}}^{2}}}}}}{{{12}} {{{h}^{4}}}}& \frac{{{{4}} {{{\bar{x}}^{3}}}}{-{{{4}} {{{h}^{3}}}}} + {{{3}} {{h}} {{{\bar{x}}^{2}}}}{-{{{8}} {{\bar{x}}} \cdot {{{h}^{2}}}}}}{{{6}} {{{h}^{4}}}}& \frac{{{\bar{x}}} \cdot {{\left({{-{{{2}} {{{\bar{x}}^{2}}}}} + {{{5}} {{{h}^{2}}}}}\right)}}}{{{2}} {{{h}^{4}}}}& \frac{{{{4}} {{{\bar{x}}^{3}}}} + {{{4}} {{{h}^{3}}}}{-{{{3}} {{h}} {{{\bar{x}}^{2}}}}}{-{{{8}} {{\bar{x}}} \cdot {{{h}^{2}}}}}}{{{6}} {{{h}^{4}}}}& \frac{{-{{h}^{3}}}{-{{{2}} {{{\bar{x}}^{3}}}}} + {{{\bar{x}}} \cdot {{{h}^{2}}}} + {{{3}} {{h}} {{{\bar{x}}^{2}}}}}{{{12}} {{{h}^{4}}}}\\ \frac{{-{{h}^{4}}} + {{{6}} {{{\bar{x}}^{2}}} {{{h}^{2}}}} + {{{6}} {{\bar{x}}} \cdot {{{h}^{3}}}}}{{{24}} {{{h}^{6}}}}& \frac{{{{4}} {{{h}^{4}}}}{-{{{6}} {{{\bar{x}}^{2}}} {{{h}^{2}}}}}{-{{{3}} {{\bar{x}}} \cdot {{{h}^{3}}}}}}{{{6}} {{{h}^{6}}}}& \frac{{-{{{5}} {{{h}^{4}}}}} + {{{6}} {{{\bar{x}}^{2}}} {{{h}^{2}}}}}{{{4}} {{{h}^{6}}}}& \frac{{{{4}} {{{h}^{4}}}}{-{{{6}} {{{\bar{x}}^{2}}} {{{h}^{2}}}}} + {{{3}} {{\bar{x}}} \cdot {{{h}^{3}}}}}{{{6}} {{{h}^{6}}}}& \frac{{-{{h}^{4}}} + {{{6}} {{{\bar{x}}^{2}}} {{{h}^{2}}}}{-{{{6}} {{\bar{x}}} \cdot {{{h}^{3}}}}}}{{{24}} {{{h}^{6}}}}\\ -{\frac{{h} + {{{2}} {{\bar{x}}}}}{{{12}} {{{h}^{4}}}}}& \frac{{h} + {{{4}} {{\bar{x}}}}}{{{6}} {{{h}^{4}}}}& -{\frac{\bar{x}}{{h}^{4}}}& \frac{{-{h}} + {{{4}} {{\bar{x}}}}}{{{6}} {{{h}^{4}}}}& \frac{{h}{-{{{2}} {{\bar{x}}}}}}{{{12}} {{{h}^{4}}}}\\ \frac{1}{{{24}} {{{h}^{4}}}}& -{\frac{1}{{{6}} {{{h}^{4}}}}}& \frac{1}{{{4}} {{{h}^{4}}}}& -{\frac{1}{{{6}} {{{h}^{4}}}}}& \frac{1}{{{24}} {{{h}^{4}}}}\end{array}\right]}} {{\left[\begin{array}{c} {y_{1}}\\ {y_{2}}\\ {y_{3}}\\ {y_{4}}\\ {y_{5}}\end{array}\right]}}}$
<br>

<br>
let	${\bar{x}} = {x}$
<br>
${\frac{\partial p(x)}{\partial x}} \approx {{{\frac{1}{h}}} {{{\frac{1}{12}}{\left({{{y_{1}}}{-{{y_{5}}}}{-{{{8}} {{{y_{2}}}}}} + {{{8}} {{{y_{4}}}}}}\right)}}}}$
<br>

<br>
${\frac{\partial p(x)}{\partial x}} \approx {{{\frac{1}{h}}} {{\left[\begin{array}{ccccc} \frac{1}{12}& -{\frac{2}{3}}& 0& \frac{2}{3}& -{\frac{1}{12}}\end{array}\right]}} {{\left[\begin{array}{c} {y_{1}}\\ {y_{2}}\\ {y_{3}}\\ {y_{4}}\\ {y_{5}}\end{array}\right]}}}$
<br>
<h3>Numericaly:</h3>
<br>
<h3>...2 order</h3>
<br>
${A} = {\left[\begin{array}{ccc} 1& -1& 1\\ 1& 0& 0\\ 1& 1& 1\end{array}\right]}$
<br>
${det(A)} = {2}$
<br>
${{A}^{-1}} = {\left[\begin{array}{ccc} 0& 1& 0\\ -.5& 0& .5\\ .5& -1& .5\end{array}\right]}$
<br>
${{A}^{-1}} = {{{\frac{1}{2}}} {{\left[\begin{array}{ccc} 0& 2& 0\\ -1& 0& 1\\ 1& -2& 1\end{array}\right]}}}$
<br>
${{{{A}^{-1}}} {{x}}} = {\left[\begin{array}{ccc} \frac{-1}{2}& \frac{0}{2}& \frac{1}{2}\end{array}\right]}$
<br>
<h3>...4 order</h3>
<br>
${A} = {\left[\begin{array}{ccccc} 1& -2& 4& -8& 16\\ 1& -1& 1& -1& 1\\ 1& 0& 0& 0& 0\\ 1& 1& 1& 1& 1\\ 1& 2& 4& 8& 16\end{array}\right]}$
<br>
${det(A)} = {288}$
<br>
${{A}^{-1}} = {\left[\begin{array}{ccccc} 0& 0& 1& 0& 0\\ .1[0]& -.6[6]& 0& .665[8]& -.083[3]\\ -.0[3]& .6[6]& -1.25& .6662[4]& -.041[6]\\ -.1[0]& .1[6]& 0& -.1658[3]& .083[3]\\ .0[3]& -.1[6]& .25& -.16625& .041[6]\end{array}\right]}$
<br>
${{A}^{-1}} = {{{\frac{1}{288}}} {{\left[\begin{array}{ccccc} 0& 0& 288& 0& 0\\ 28.8& -191.9[9]& 0& 191.775[9]& -23.999[9]\\ -9.5[9]& 191.9[9]& -360& 191.8783[9]& -11.999[9]\\ -28.8& 47.9[9]& 0& -47.7599[9]& 23.999[9]\\ 9.5[9]& -47.9[9]& 72& -47.88& 11.999[9]\end{array}\right]}}}$
<br>
${{{{A}^{-1}}} {{x}}} = {\left[\begin{array}{ccccc} \frac{28.8}{288}& \frac{-191.9[9]}{288}& \frac{0}{288}& \frac{191.775[9]}{288}& \frac{-23.999[9]}{288}\end{array}\right]}$
<br>
<h3>...6 order</h3>
<br>
${A} = {\left[\begin{array}{ccccccc} 1& -3& 9& -27& 81& -243& 729\\ 1& -2& 4& -8& 16& -32& 64\\ 1& -1& 1& -1& 1& -1& 1\\ 1& 0& 0& 0& 0& 0& 0\\ 1& 1& 1& 1& 1& 1& 1\\ 1& 2& 4& 8& 16& 32& 64\\ 1& 3& 9& 27& 81& 243& 729\end{array}\right]}$
<br>
${det(A)} = {24883200}$
<br>
${{A}^{-1}} = {\left[\begin{array}{ccccccc} .0[0]& 0& 0& .9[9]& 0& 0& 0\\ -.1764[0]& .17966[7]& -.7500500[1]& .002550119[4]& .7499886922[1]& -.14999499[8]& .0166[6]\\ -.14323[8]& -.06011[0]& .7499833[2]& -1.35608610[8]& .7499937344[4]& -.07499833[2]& .0055[5]\\ .07391[6]& -.19958[3]& .2708958[4]& .00279165623& -.2708212958[3]& .16666041[5]& -.0208[3]\\ .04602[7]& .06680[5]& -.2708125& .3889305520[8]& -.2708265430[5]& .08333125& -.0069[4]\\ -.0086[1]& .01991[6]& -.0208458[4]& -.00034166458[3]& .0208325925[0]& -.01666541[6]& .0041[6]\\ -.0027[8]& -.00669[4]& .0208291[6]& -.02784444375& .0208328086[1]& -.00833291[6]& .0013[8]\end{array}\right]}$
<br>
